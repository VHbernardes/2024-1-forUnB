{% extends "main/base.html" %}

{% block content %}

{% load custom_filters %}
<div class="custom-container mt-5 ms-0">
    <div class="question-item">
        <div class="question-info">
            <div class="question-meta">
                <span class="question-author">{{ question.author.username }}</span> • 
                <span class="question-date">há {{ question.created_at|custom_timesince }}</span>
            </div>
            <h5 class="question-title">{{ question.title }}</h5>
            <p class="question-description">{{ question.description }}</p>
            <div class="action-buttons">
                <button class="btn btn-like" onclick="toggleLike(this);">
                    <i class="bi bi-heart"></i>
                </button>
                <a href="{% url 'question_detail' question.id %}" class="btn btn-info">
                    <i class="bi bi-chat-left-text"></i> {{ question.answers.count }}
                </a>
            </div>   
            <div class="response-area">
                <input type="text" class="form-control" placeholder="Adicionar uma resposta" onclick="showResponseForm()" readonly>
                <div class="response-form d-none">
                    <textarea class="form-control mt-2" placeholder="Escreva sua resposta..."></textarea>
                    <div class="mt-1">
                        <button class="btn btn-cancel" onclick="cancelResponse()">Cancelar</button>
                        <button class="btn btn-send">Enviar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <h3>Respostas:</h3>
    {% if answers %}
        {% for answer in answers %}
            <div class="answer-card">
                <h5>Por {{ answer.author.username }} em {{ answer.created_at }}</h5>
                <p>{{ answer.text }}</p>
                <hr>
            </div>
        {% empty %}
            <p>Nenhuma resposta encontrada para esta pergunta.</p>
        {% endfor %}
    {% else %}
        <p>Nenhuma resposta encontrada para esta pergunta.</p>
    {% endif %}
</div>

<script>
    function showResponseForm() {
        var responseInput = document.querySelector('.response-area input');
        var responseForm = document.querySelector('.response-form');
        var textarea = responseForm.querySelector('textarea');

        if (responseInput && responseForm && textarea) {
            responseInput.classList.add('d-none');
            responseForm.classList.remove('d-none');
            textarea.focus(); // Coloca o foco no campo de texto
        } else {
            console.error('Elementos não encontrados.');
        }
    }

    function cancelResponse() {
        var responseInput = document.querySelector('.response-area input');
        var responseForm = document.querySelector('.response-form');
        
        if (responseInput && responseForm) {
            responseInput.classList.remove('d-none');
            responseForm.classList.add('d-none');
        } else {
            console.error('Elementos não encontrados.');
        }
    }
</script>


{% endblock %}